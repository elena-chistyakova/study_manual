# Настройка кнопки вызова утилиты на экранной форме МИС

Для вызова утилиты непосредственно из МИС МЕДИАЛОГ необходимо разместить кнопку типа **Команда Windows** на экранной форме, связанной с регистрацией документов, удостоверяющих личность (например, на экранной форме **Административные данные** титульного листа пациента).
В настройках кнопки на вкладке **Параметры запуска** <a href="#рис_8">рис.8</a> необходимо в поле **Заголовок** ввести название кнопки, в поле **Выполнить файл** – путь к исполняемому файлу, обязательно установить флажок **Ожидать выполнение команды**. Если утилита была размещена в каталоге клиентского приложения, путь к исполняемому файлу рекомендуется указать в формате *%working_dir%\PassportReader\PassportReader.exe*.
 
<a name="рис_8"></a>

| ![Рисунок 8. Параметры запуска утилиты](../images/PerceiveID_setup_2.png "Рисунок 8. Параметры запуска утилиты") |
|:--:| 
| *Рисунок 8. Параметры запуска утилиты* |

В поле **Параметры** могут быть заданы ключи, определяющие параметры запуска утилиты. Может быть указано несколько ключей, записанных через пробел.

| Ключ | Название ключа | Описание |
|:--|:--|:--|
| **-c** |	Запрашивать подтверждение, даже если не обнаружено ошибок |	Если в параметрах запуска утилиты задать ключ **-c**, то после выполнения распознавания документа раздел с распознанными данными будет всегда открываться в режиме редактирования рис.6, даже если не возникло ошибок распознавания. Данный ключ не имеет дополнительных параметров. |
| **-m** | Минимизировать после выполнения	| Если в параметрах запуска утилиты задать ключ **-m**, то после окончания процедуры сканирования и распознавания утилита сворачивается в трей, а не завершает свою работу полностью. Данный ключ может быть необходим, особенно при больших объемах сканирования, т.к. первый запуск программы как правило очень долгий. Данный ключ не имеет дополнительных параметров. |
| **-s** |	Сканировать | Если в параметрах запуска задан ключ **-s**, то после запуска утилиты будет автоматически запущен процесс сканирования. Данный ключ не имеет дополнительных параметров. |
| **-r** |	Распознать	| Если в параметрах запуска задан ключ **-r**, то по окончании сканирования автоматически начнется процесс распознавания. Ключ **-r** не может быть задан без ключа **-s**. Данный ключ не имеет дополнительных параметров. |
| **-d N**	| Использовать заданный драйвер сканера | С помощью ключа **-d N** может быть задан сканер, который необходимо использовать. Параметр **N** ключа – номер сканера, который указан в скобках в конце соответствующей строки в окне выбора сканера <a href="#рис_8">рис.8</a>. Если данный ключ не задан – при сканировании будет взято значение сканера из файла *PassportReader.ini*. |
| **-w** |	Показывать окно, если было скрыто |	Если указан ключ **-**w, то окно утилиты будет отображаться, даже если оно было спрятано в трей. Данный ключ не имеет дополнительных параметров. |
| **-t <templatename>**	| Шаблон распознавания | С помощью ключа **-t <templatename>** может быть задан файла шаблона распознавания, где **<templatename>** – название файла шаблона распознавания. Если данный ключ не задан – при сканировании будет взято значение из файла *PassportReader.ini*. |
| **-o <filename>** | Файл для сохранения результата распознавания | С помощью ключа **-o <filename>** может быть задано имя файла XML и путь к нему, в который будет сохранятся результат распознавания. Задание данного ключа необходимо, если полученные в результате сканирования и распознавания данные должны быть загружены в базу данных. |
| **-p <filename>** | Файл для сохранения скана | С помощью ключа **-p <filename>** может быть задано имя графического файла и путь к нему, в который должно сохраняться изображение документа, полученное при сканировании (если не задано, то будет сформирован файл *<имя xml файла>.jpg*). Данный файл (с полным путем к нему) также будет указан в итоговом файле XML в теге IMAGE. |

Пример строки параметров:
```-c -m -s -r -d 1 -t Passport_RU -o G:\TEST\scan\doc.XML```

Данные набор ключей дает следующее: при запуске утилиты автоматически будет запущено сканирование, а затем и распознавание. Сканирование будет осуществляться на сканере в номером "1" в списке (на <a href="#рис_8">рис.8</a> это *EPSON XP-340 Series*), распознавание будет осуществляться в соответствии с шаблоном паспорта РФ. По окончании распознавания раздел с данными будет открыт в режиме редактирования, при сохранении данных они будут сохранены в файле *doc.xml*. По окончания процесса сканирования утилита свернется в трей.

Если полученные в результате сканирования и распознавания данные должны быть загружены в базу данных необходимо выполнить соответствующие настройки на вкладке Параметры импорта данных <a href="#рис_9">рис.9</a>.

<a name="рис_9"></a>

| ![Рисунок 9. Параметры импорта данных](../images/PerceiveID_setup_3.png "Рисунок 9. Параметры импорта данных") |
|:--:| 
| *Рисунок 9. Параметры импорта данных* |

В поле **Импортируемый файл** необходимо указать файл, в который сохраняются результаты сканирования (указанный в параметре ключа **-o**). Файл рекомендуется сохранять в каталоге утилиты, и если утилита была размещена в каталоге клиентского приложения, путь для сохранения файла рекомендуется указать в формате *[WorkingDir]\PassportReader\PRResult.xml*.
В нижней части вкладке выбрать таблицу (таблицы), в которую должны вносится распознанные данные, настроить связь полей таблицы и XML файла.
